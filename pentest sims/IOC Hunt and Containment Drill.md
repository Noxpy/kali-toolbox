# IOC Hunt and Containment Drill

## Estimated Time Needed
60 minutes

## Overview

This lab simulates defender activity after an intrusion. You will identify persistence mechanisms (cron jobs, autostart files, malicious temp scripts, rogue services), contain them safely by quarantining rather than deleting, verify remediation, and document your findings.

**Safety Note**: Perform these steps only on the lab VM. Always move (quarantine) instead of deleting to ensure evidence is preserved.

## Learning Objectives

After completing this lab, you will be able to:

- Enumerate persistence across cron jobs, init systems, autostart profiles, and temp directories.
- Apply containment best practices (quarantine, disable, document).
- Verify remediation by re-checking processes and sockets.
- Document findings and map to MITRE ATT&CK.

---

## Exercise 0: Environment and Pre-checks

### Steps

1. **Check Current User:**

    Run the following command to verify your current user:
    
    ```bash
    whoami
    ```

2. **Check User and Group IDs:**

    Run this command to check your user and group IDs:
    
    ```bash
    id
    ```

3. **Check Sudo Permissions:**

    Run the following command to see your sudo permissions (if available):
    
    ```bash
    sudo -l 2>/dev/null || echo "No sudo or not permitted"
    ```

4. **Create Evidence Directory:**

    Run this command to create the directory where you will store evidence:
    
    ```bash
    mkdir -p /tmp/ioc_evidence
    ```

### Why This Step Is Important

- **`whoami`**: Confirms that you are operating on the compromised host with the correct privileges.
- **`id`**: Displays your user/group IDs for auditing purposes.
- **`sudo -l`**: Checks if you have any sudo permissions, which may be relevant for performing elevated actions during the investigation.
- **Evidence Directory (`/tmp/ioc_evidence`)**: Ensures outputs and copies are preserved for later analysis. This is crucial for documenting findings and retaining evidence.

### Expected Output

- **`whoami`**: Your current user (for example, `root` or `msfadmin`).
- **`id`**: User and group IDs of the current user.
- **`sudo -l`**: Sudo permissions, or a message indicating that you do not have sudo privileges.
- **Evidence Directory**: The command will create the directory `/tmp/ioc_evidence` if it doesn't already exist.

---

## Additional Notes

- During this lab, **quarantine** means moving suspicious files to a safe location rather than deleting them, ensuring that you preserve evidence for analysis and documentation.
- After completing the steps, continue to identify persistence mechanisms and apply containment best practices throughout the lab.
